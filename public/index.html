<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Phone Changer</title>
    <link
      rel="stylesheet"
      href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"
    />
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
    />

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <style>
      body {
        padding-top: 60px;
      }
    </style>
    <script>
      $(function () {
        $("#phoneChangerForm").submit(function (event) {
          event.preventDefault();

          var errorMessage = $("#errorMessage");
          var error = $("#error");
          error.hide();

          $("#message").hide();

          var firstName = $("#firstName").val();
          var lastName = $("#lastName").val();
          var email = $("#email").val();
          var phone = $("#phone").val();

          if (
            firstName.length == 0 ||
            lastName.length == 0 ||
            email.length == 0 ||
            phone.length == 0
          ) {
            errorMessage.text("All of the fields are required.");
            error.show();
          } else {
            $.ajax({
              url: event.target.action,
              method: event.target.method,
              data: JSON.stringify({
                firstName: firstName,
                lastName: lastName,
                email: email,
                phone: phone,
              }),
              contentType: "application/json; charset=utf-8",
              dataType: "json",
              success: function (data) {
                $("#firstName").val("");
                $("#lastName").val("");
                $("#email").val("");
                $("#phone").val("");
                $("#messageMessage").text("Record updated!");
                $("#message").show();
              },
              error: function (err) {
                errorMessage.text(err.responseJSON.error);
                error.show();
              },
            });
          }
        });
      });
    </script>
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="/">Home</a>
        </div>
      </div>
    </nav>

    <div class="container">
      <button
        type="button"
        class="btn btn-info btn-lg"
        data-toggle="modal"
        data-target="#myModal"
      >
        Create Contact
      </button>
      <!-- Modal -->
      <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">
                &times;
              </button>
              <h4 class="modal-title">Create contact</h4>
            </div>
            <div class="modal-body">
              <form id="phoneChangerForm" action="/update" method="post">
                <div class="panel panel-default">
                  <div class="panel-body">
                    <div class="form-group">
                      <label for="firstName">First Name</label>
                      <input
                        type="text"
                        class="form-control"
                        id="firstName"
                        placeholder="For verification"
                        required
                      />
                    </div>
                    <div class="form-group">
                      <label for="lastName">Last Name</label>
                      <input
                        type="text"
                        class="form-control"
                        id="lastName"
                        placeholder="For verification"
                        required
                      />
                    </div>
                    <div class="form-group">
                      <label for="email">Email</label>
                      <input
                        type="email"
                        class="form-control"
                        id="email"
                        placeholder="For verification"
                        required
                      />
                    </div>
                    <div class="form-group">
                      <label for="phone">Phone</label>
                      <input
                        type="tel"
                        class="form-control"
                        id="phone"
                        placeholder="New Phone Number"
                        required
                      />
                    </div>
                  </div>
                  <div class="panel-footer">
                    <div
                      id="message"
                      class="alert alert-info"
                      role="alert"
                      style="display: none"
                    >
                      <span
                        class="glyphicon glyphicon-ok"
                        aria-hidden="true"
                      ></span>
                      <span id="messageMessage"></span>
                    </div>
                    <div
                      id="error"
                      class="alert alert-danger"
                      role="alert"
                      style="display: none"
                    >
                      <span
                        class="glyphicon glyphicon-exclamation-sign"
                        aria-hidden="true"
                      ></span>
                      <span class="sr-only">Error:</span>
                      <span id="errorMessage"></span>
                    </div>
                  </div>
                </div>
                <button type="submit" class="btn btn-primary">
                Update Phone Number
              </button>
              </form>
            </div>
            <div class="modal-footer">
              <button type="submit" class="btn btn-primary">
                Update Phone Number
              </button>
            </div>
          </div>
        </div>
      </div>
      <div *ngFor="let contact of conta">
         <p>{{contact.firstname}}</p>
      </div>
    </div>
  </body>
</html>
